
% READ DE430 MODEL COEFFICIENTS FOR PLANETARY EPHEMERIDES
% ---------------------------------------------------------------------------------------------------------------------
% Function reads coefficients for JPL's DE430 model defining the state of planetary bodies in the solar system at a
% given time. Position/Velocity computed using coefficients and Chebyshev Polynomials.
%
% Using DE430t files, which contain TT-TDB information and have usable header with all coefficients
% Enter range of Modified Julian Dates based in Terrestrial Time (TT), function returns coefficient data sets from 
% DE430 model covering range of dates. DE430coef can be used as outputted for planet_ephemerides.m, but must be 
% transposed for planet_ephemerides_c.m (mex version of function)
%
% Author: Matthew Buckhout
% Updated: 09/07/2020 
%
% JPL DE430 Model for Planetary Ephemerides
%     https://ssd.jpl.nasa.gov/?planet_eph_export
%
% Range of data: 1550 to 2650 AD
%
% Local filenames: "DE430t_1550_E.txt"
%                  "DE430t_1650_E.txt"
%                  "DE430t_1750_E.txt"
%                  "DE430t_1850_E.txt"
%                  "DE430t_1950_E.txt"
%                  "DE430t_2050_E.txt"
%                  "DE430t_2150_E.txt"
%                  "DE430t_2250_E.txt"
%                  "DE430t_2350_E.txt"
%                  "DE430t_2450_E.txt"
%                  "DE430t_2550_E.txt"
% Data Format:
% -----------------------------------------------------------------------------
%      1   982
%    0.2433264500000000E+07    0.2433296500000000E+07    0.4416951459393930E+08
%    0.8080851912982977E+07   -0.7484298492585709E+06   -0.4071477612085195E+05
%   -0.5304223052867981E+03    0.1960084093957696E+02    0.3222303794881912E+01
%    0.2083022564266313E+00    0.8945618998892751E-02    0.1631530233962896E-03
%   -0.1340538183758198E-04   -0.1759843376009009E-05   -0.1178977685715121E-06
%   -0.5795974672227543E-08   -0.3471755766803709E+08    0.1180024293725848E+08
%    0.5886270831010747E+06   -0.1892126625519061E+05   -0.1424502642170013E+04
%   -0.6553857374183939E+02   -0.1986120049462273E+01    0.1319147998717973E-01
%    0.6570858119910509E-02    0.5478562345174842E-03    0.2866171808227998E-04
%    0.8511734284025930E-06   -0.1611214918998700E-07   -0.4661167239464407E-08
%   -0.2316274917032808E+08    0.5462945065742004E+07    0.3921001809888466E+06
%   -0.5876970505092934E+04   -0.7057059844372419E+03   -0.3703820254960247E+02
%   -0.1395389438024304E+01   -0.1458790514309717E-01    0.2580291891778922E-02
%    0.2756524924257126E-03    0.1670048076972359E-04    0.6372202444298476E-06
% -----------------------------------------------------------------------------


% Output Format [DE430coef]:
% -----------------------------------------------------------------------------
%    1	                      982	                     0
%    2433264.5	                2433296.5	               0.4416951459393930E+08
%    0.8080851912982977e+07   -0.7484298492585709e+06   -0.4071477612085195e+05
%   -0.5304223052867981e+03    0.1960084093957696e+02    0.3222303794881912e+01
%    0.2083022564266313e+00    0.8945618998892751e-02    0.1631530233962896e-03
%   -0.1340538183758198e-04   -0.1759843376009009e-05   -0.1178977685715121e-06
%   -0.5795974672227543e-08   -0.3471755766803709e+08    0.1180024293725848e+08
%    0.5886270831010747e+06   -0.1892126625519061e+05   -0.1424502642170013e+04
%   -0.6553857374183939e+02   -0.1986120049462273e+01    0.1319147998717973e-01
%    0.6570858119910509e-02    0.5478562345174842e-03    0.2866171808227998e-04
%    0.8511734284025930e-06   -0.1611214918998700e-07   -0.4661167239464407e-08
%   -0.2316274917032808e+08    0.5462945065742004e+07    0.3921001809888466e+06
%   -0.5876970505092934e+04   -0.7057059844372419e+03   -0.3703820254960247e+02
%   -0.1395389438024304e+01   -0.1458790514309717e-01    0.2580291891778922e-02
%    0.2756524924257126e-03    0.1670048076972359e-04    0.6372202444298476e-06
% -----------------------------------------------------------------------------

function [DE430coef] = getdata_DE430(MJD1_TT,MJD2_TT)

   MJD1 = MJD1_TT;
   MJD2 = MJD2_TT;

   %Reading in coefficients for DE430 model
   if ((MJD1 >= -112816) && (MJD1 < -76304) && (MJD2 >= -112816) && (MJD2 < -76304)) %1550 - 1650
      DE430coef = dlmread('DE430t_1550_E.txt');

   elseif ((MJD1 >= -76304) && (MJD1 < -39792) && (MJD2 >= -76304) && (MJD2 < -39792)) %1650 - 1750
      DE430coef = dlmread('DE430t_1650_E.txt');
      
   elseif ((MJD1 >= -39792) && (MJD1 < -3248) && (MJD2 >= -39792) && (MJD2 < -3248)) %1750 - 1850
      DE430coef = dlmread('DE430t_1750_E.txt');
      
   elseif ((MJD1 >= -3248) && (MJD1 < 33264) && (MJD2 >= -3248) && (MJD2 < 33264)) %1850 - 1950
      DE430coef = dlmread('DE430t_1850_E.txt');
      
   elseif ((MJD1 >= 33264) && (MJD1 < 69776) && (MJD2 >= 33264) && (MJD2 < 69776)) %1950 - 2050
      DE430coef = dlmread('DE430t_1950_E.txt');
      
   elseif ((MJD1 >= 69776) && (MJD1 < 106320) && (MJD2 >= 69776) && (MJD2 < 106320)) %2050 - 2150
      DE430coef = dlmread('DE430t_2050_E.txt');
      
   elseif ((MJD1 >= 106320) && (MJD1 < 142832) && (MJD2 >= 106320) && (MJD2 < 142832)) %2150 - 2250
      DE430coef = dlmread('DE430t_2150_E.txt');
      
   elseif ((MJD1 >= 142832) && (MJD1 <= 179376) && (MJD2 >= 142832) && (MJD2 <= 179376)) %2250 - 2350
      DE430coef = dlmread('DE430t_2250_E.txt');
      
   elseif ((MJD1 >= 179376) && (MJD1 <= 215888) && (MJD2 >= 179376) && (MJD2 <= 215888)) %2350 - 2450
      DE430coef = dlmread('DE430t_2350_E.txt');
      
   elseif ((MJD1 >= 215888) && (MJD1 <= 252400) && (MJD2 >= 215888) && (MJD2 <= 252400)) %2450 - 2550
      DE430coef = dlmread('DE430t_2450_E.txt');
      
   elseif ((MJD1 >= 252400) && (MJD1 <= 288976) && (MJD2 >= 252400) && (MJD2 <= 288976)) %2550 - 2650
      DE430coef = dlmread('DE430t_2550_E.txt');
      
   else   
      fprintf('Input Date outside range 1550-2650\n');
   end

end
